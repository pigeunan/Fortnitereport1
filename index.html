<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>í´ë¦­ ì±Œë¦°ì§€ â€” 5ì´ˆ ì•ˆì— ìµœëŒ€í•œ ë§ì´ í´ë¦­!</title>
<style>
  :root{--bg:#071028;--card:#0e1630;--accent:#ffb84d;--muted:#96a3b6}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter, "Apple SD Gothic Neo",system-ui;background:linear-gradient(180deg,var(--bg),#02040a);color:#e7f0ff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
  .container{width:980px;max-width:96%;display:grid;grid-template-columns:1fr 320px;gap:18px;align-items:start}
  .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:14px;padding:24px;box-shadow:0 18px 50px rgba(0,0,0,.6)}
  h1{margin:0 0 8px;font-size:22px}
  p.lead{margin:0 0 12px;color:var(--muted)}
  /* challenge panel */
  .panel{background:rgba(255,255,255,0.02);border-radius:12px;padding:18px;text-align:center}
  .bigbtn{display:inline-block;padding:18px 26px;border-radius:14px;background:var(--accent);color:#111;font-weight:900;border:0;font-size:20px;cursor:pointer}
  .count{font-size:48px;font-weight:900;margin-top:10px}
  .meta{font-size:13px;color:var(--muted);margin-top:8px}
  .small{font-size:13px;color:var(--muted)}
  /* overlay & full video */
  .overlay{position:fixed;inset:0;background:#000;display:none;align-items:center;justify-content:center;z-index:9999}
  .overlay.show{display:flex}
  .vbox{position:fixed;inset:0;background:#000}
  video{position:absolute;inset:0;width:100vw;height:100vh;object-fit:cover;display:block}
  .controls{position:fixed;left:50%;bottom:26px;transform:translateX(-50%);display:flex;gap:10px;z-index:10001}
  .btn{border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
  .ghost{background:rgba(255,255,255,0.06);color:#e7eef8}
  .primary{background:var(--accent);color:#150f00}
  .notice{position:fixed;right:14px;top:14px;background:rgba(0,0,0,0.45);padding:8px 12px;border-radius:10px;color:#fff;font-weight:700;z-index:10001}
  /* animation feedback */
  .pulse{animation:pop 0.15s ease-out}
  @keyframes pop{0%{transform:scale(1)}50%{transform:scale(0.96)}100%{transform:scale(1)}}
</style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>í´ë¦­ ì±Œë¦°ì§€ â€” 5ì´ˆì— ìµœëŒ€í•œ ë§ì´ ëˆ„ë¥´ì„¸ìš”!</h1>
      <p class="lead">ëª©í‘œë¥¼ ë‹¬ì„±í•˜ë©´ 'íŠ¹ë³„í•œ ë³´ìƒ'ì´ ì£¼ì–´ì§‘ë‹ˆë‹¤. ì¹œêµ¬ë‘ ë‚´ê¸°í•˜ë©´ ë” ì¬ë°ŒìŒ ğŸ˜‰</p>
      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
        <div style="flex:1">
          <div style="font-size:14px;color:var(--muted)">ê·œì¹™</div>
          <ul style="margin:8px 0 0 18px;color:var(--muted)">
            <li>ì œí•œ ì‹œê°„: <strong>5ì´ˆ</strong></li>
            <li>ëª©í‘œ í´ë¦­ ìˆ˜: <strong id="targetLabel">20</strong> íšŒ</li>
            <li>ëª©í‘œë¥¼ ë¨¼ì € ë‹¬ì„±í•˜ë©´ ê·¸ ì¦‰ì‹œ ì˜ìƒì´ ì—°ì¶œë˜ê³  ì†Œë¦¬ë„ í•¨ê»˜ ë‚©ë‹ˆë‹¤!</li>
            <li>ë‹¬ì„± ëª» í•˜ë©´ ì˜ìƒì€ ìŒì†Œê±° ìƒíƒœë¡œ ë‚˜íƒ€ë‚˜ë©°, ì†Œë¦¬ ì¼œê¸° ë²„íŠ¼ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.</li>
          </ul>
        </div>

        <div style="width:320px">
          <div class="panel">
            <div style="font-size:15px;font-weight:800">ë‚¨ì€ ì‹œê°„</div>
            <div class="count" id="timeDisplay">5</div>
            <div style="height:12px"></div>
            <button id="clickBtn" class="bigbtn">ì—¬ê¸°ë¥¼ ì—°íƒ€! ğŸ”´</button>
            <div class="meta" style="margin-top:10px">í´ë¦­ ìˆ˜: <span id="clickCount">0</span></div>
            <div class="meta" style="margin-top:6px">ëª©í‘œ: <span id="targetCount">20</span></div>
            <div class="small" style="margin-top:8px">ì¹œêµ¬ì™€ ê²½ìŸí•´ë´ â€” ëˆ„ê°€ ë” ë§ì´ ëˆ„ë¥´ë‚˜?</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card" style="display:flex;flex-direction:column;gap:12px;align-items:flex-start">
      <h1 style="font-size:18px;margin-bottom:6px">ë„ì›€ë§</h1>
      <p class="small">- í´ë¦­ì€ ë§ˆìš°ìŠ¤/í„°ì¹˜ ëª¨ë‘ ë™ì‘í•©ë‹ˆë‹¤.<br>- í´ë¦­ ìˆœê°„ì˜ 'ë§ˆì§€ë§‰ í´ë¦­' ì´ë²¤íŠ¸ ì•ˆì—ì„œ ì†Œë¦¬ ì¬ìƒì„ ì‹œë„í•˜ë¯€ë¡œ, ì¶©ë¶„íˆ ì—°íƒ€í•˜ë©´ ê°‘ìê¸° í¬ê²Œ ìš¸ë¦½ë‹ˆë‹¤.</p>
      <p class="small">- ë‹«ê¸°(ESC)ë‚˜ ë‹«ê¸° ë²„íŠ¼ìœ¼ë¡œ ì–¸ì œë“  ì¤‘ë‹¨í•  ìˆ˜ ìˆì–´ìš”.</p>
      <div style="margin-top:auto;color:var(--muted);font-size:12px">ì•ˆì „: íƒ€ì¸ì—ê²Œ ë¶ˆì¾Œê°ì„ ì£¼ëŠ” ìš©ë„ëŠ” í”¼í•˜ì„¸ìš”.</div>
    </div>
  </div>

  <!-- overlay: full-screen video -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="vbox">
      <video id="vid" playsinline preload="auto" muted>
        <source src="https://github.com/pigeunan/myvideo/raw/refs/heads/main/cm-chat-media-video-1016a9fde-00c2-5fca-b544-014ee5d7809422100_1.mp4" type="video/mp4">
        ë¸Œë¼ìš°ì €ê°€ ë¹„ë””ì˜¤ íƒœê·¸ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
      </video>
      <div class="controls" id="overlayControls" style="display:none">
        <button class="btn primary" id="forceUnmute">ì†Œë¦¬ ì¼œê¸° (ê°•í•˜ê²Œ)</button>
        <button class="btn ghost" id="closeOverlay">ë‹«ê¸°</button>
      </div>
      <div class="notice" id="overlayNotice" style="display:none">âš ï¸ ì†Œë¦¬ê°€ í¬ê²Œ ë‚˜ì˜µë‹ˆë‹¤. ì£¼ì˜í•˜ì„¸ìš”.</div>
    </div>
  </div>

<script>
  // ì„¤ì •
  const TIME_LIMIT = 5; // seconds
  const TARGET = 20; // clicks needed to trigger immediate unmute/reveal

  // ìš”ì†Œ
  const timeDisplay = document.getElementById('timeDisplay');
  const clickBtn = document.getElementById('clickBtn');
  const clickCountEl = document.getElementById('clickCount');
  const targetCountEl = document.getElementById('targetCount');
  const targetLabel = document.getElementById('targetLabel');

  const overlay = document.getElementById('overlay');
  const vid = document.getElementById('vid');
  const overlayControls = document.getElementById('overlayControls');
  const overlayNotice = document.getElementById('overlayNotice');
  const forceUnmute = document.getElementById('forceUnmute');
  const closeOverlay = document.getElementById('closeOverlay');

  targetCountEl.textContent = TARGET;
  targetLabel.textContent = TARGET;

  let clicks = 0;
  let timeLeft = TIME_LIMIT;
  let intervalId = null;
  let challengeActive = false;
  let triggered = false; // whether we already triggered unmute+reveal

  // ì‹œì‘: íƒ€ì´ë¨¸
  function startChallenge(){
    if (challengeActive) return;
    challengeActive = true;
    timeDisplay.textContent = timeLeft;
    intervalId = setInterval(()=> {
      timeLeft--;
      timeDisplay.textContent = timeLeft;
      if (timeLeft <= 0) {
        clearInterval(intervalId);
        endChallenge();
      }
    }, 1000);
  }

  // í´ë¦­ ì²˜ë¦¬ (ë§ˆìš°ìŠ¤ ë˜ëŠ” í„°ì¹˜)
  function handleClick(evt){
    // ì‹œê° í”¼ë“œë°±
    clickBtn.classList.add('pulse');
    setTimeout(()=> clickBtn.classList.remove('pulse'), 140);

    // ì‹œì‘ ì•ˆ í–ˆìœ¼ë©´ ì‹œì‘
    if (!challengeActive) startChallenge();

    clicks++;
    clickCountEl.textContent = clicks;

    // ì¤‘ìš”í•œ ë¶€ë¶„: ì‚¬ìš©ìì˜ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë‚´ë¶€ì—ì„œ 'play + unmute' ì‹œë„ ê°€ëŠ¥
    // ë§Œì•½ ëª©í‘œ í´ë¦­ì— ë„ë‹¬í•˜ë©´ 'ì¦‰ì‹œ' ì˜¤ë²„ë ˆì´ + ì–¸ë®¤íŠ¸ ì¬ìƒì„ ì‹¤í–‰í•œë‹¤.
    if (!triggered && clicks >= TARGET) {
      triggered = true;
      showOverlay(true /*unmuteNow*/);
    }
  }

  clickBtn.addEventListener('pointerdown', handleClick, {passive:true});

  // ì±Œë¦°ì§€ ì¢…ë£Œ(íƒ€ì„ì•„ì›ƒ)
  async function endChallenge(){
    // ì±Œë¦°ì§€ ë. ë§Œì•½ ì´ë¯¸ triggered (ëª©í‘œ ë„ë‹¬) ìƒíƒœë¼ë©´ ì•„ë¬´ê²ƒë„ ì•ˆ í•¨
    if (triggered) return;
    // ëª©í‘œì— ëª» ë¯¸ì³¤ë‹¤ë©´ ì˜¤ë²„ë ˆì´ë¥¼ 'ìŒì†Œê±° ìƒíƒœ'ë¡œ ë³´ì—¬ì¤Œ
    showOverlay(false /*unmuteNow*/);
  }

  // ì˜¤ë²„ë ˆì´ ë³´ì´ê¸° â€” unmuteNowê°€ trueì´ë©´ 'í˜„ì¬ ì‚¬ìš©ì ì œìŠ¤ì²˜' ì»¨í…ìŠ¤íŠ¸ì—ì„œ í˜¸ì¶œë˜ì–´ì•¼ í•¨.
  // ìš°ë¦¬ëŠ” ëª©í‘œ ë„ë‹¬ ì‹œ (click handler ì•ˆ) í˜¸ì¶œí•˜ë¯€ë¡œ ê·¸ë•ŒëŠ” ì‚¬ìš©ì ì œìŠ¤ì²˜ ì»¨í…ìŠ¤íŠ¸ì„.
  // ë§Œì•½ íƒ€ì„ì•„ì›ƒì—ì„œ í˜¸ì¶œí•˜ë©´ (ë¹„ì‚¬ìš©ì ì œìŠ¤ì²˜) ìë™ ì–¸ë®¤íŠ¸ëŠ” ì‹œë„í•˜ì§€ ì•ŠìŒ.
  async function showOverlay(unmuteNow){
    overlay.classList.add('show');
    overlay.setAttribute('aria-hidden','false');

    // overlayê°€ ë³´ì´ë©´ ì „ì²´í™”ë©´ ì‹œë„ (ë¸Œë¼ìš°ì €ê°€ í—ˆìš©í•˜ë©´)
    try{
      if (overlay.requestFullscreen) await overlay.requestFullscreen();
    }catch(e){ /* ignore */ }

    // í•­ìƒ ë¹„ë””ì˜¤ ì¬ìƒ ì¤€ë¹„
    try {
      // if unmuteNow is true, do unmute+play in this user gesture context
      if (unmuteNow) {
        // ensure muted -> false and play within the click event (user gesture)
        vid.muted = false;
        vid.volume = 1.0;
        await vid.play();
        overlayControls.style.display = 'flex';
        overlayNotice.style.display = 'block';
      } else {
        // show muted playback (autoplay muted usually allowed)
        vid.muted = true;
        try { await vid.play(); } catch(e){ /* ignore */ }
        overlayControls.style.display = 'flex';
        overlayNotice.style.display = 'block';
      }
    } catch(err) {
      // ì¬ìƒ ì‹¤íŒ¨ì‹œì—ë„ ì˜¤ë²„ë ˆì´ëŠ” ë³´ì—¬ì¤Œ
      console.warn('play error', err);
      overlayControls.style.display = 'flex';
      overlayNotice.style.display = 'block';
    }
  }

  // ë§Œì•½ ëª©í‘œ ë‹¬ì„± í›„ ìœ ì €ê°€ ë” í´ë¦­í•˜ë©´ ì¶”ê°€ í–‰ë™ ë§‰ê¸°
  // ìˆ˜ë™ìœ¼ë¡œ 'ì†Œë¦¬ ì¼œê¸°' ë²„íŠ¼
  forceUnmute.addEventListener('click', async () => {
    try{
      vid.muted = false;
      vid.volume = 1.0;
      await vid.play();
      overlayNotice.textContent = 'ì†Œë¦¬ ì¼œì§! (ESC ë˜ëŠ” ë‹«ê¸°ë¡œ ì¢…ë£Œ)';
    }catch(e){ console.warn(e); }
  });

  // ë‹«ê¸°
  closeOverlay.addEventListener('click', ()=> {
    try{ vid.pause(); vid.currentTime = 0; }catch(e){}
    if (document.fullscreenElement) document.exitFullscreen();
    overlay.classList.remove('show');
    overlay.setAttribute('aria-hidden','true');
  });

  // ESCë¡œ ë‹«ê¸°
  document.addEventListener('keydown', (e)=> {
    if (e.key === 'Escape' && overlay.getAttribute('aria-hidden') === 'false') {
      closeOverlay.click();
    }
  });

  // ì‹œì‘ ì•ˆë‚´: í˜ì´ì§€ ë¡œë“œ ì§í›„ ìë™ìœ¼ë¡œ ì±Œë¦°ì§€ ì‹œì‘ (ì›í•˜ë©´ ë°”ê¿€ ìˆ˜ ìˆìŒ)
  // ì—¬ê¸°ì„  ì‚¬ìš©ìê°€ ë°”ë¡œ ëˆ„ë¥¼ ìˆ˜ ìˆê²Œ ì‹œì‘ ìƒíƒœë¡œ ë‘ .
  startChallenge();
</script>
</body>
</html>